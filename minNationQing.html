<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>é’è—åœ°åŒºå°‘æ•°æ°‘æ—åˆ†å¸ƒå›¾</title>

    <style type="text/css">
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        .anchorBL{
            display: none;
        }
        
        @font-face { 
            font-family: 'æ–°å­—ä½“';  
            src: url(download/font/myFont.TTF); 
        } 
        
        .myTitle{
			z-index: 9999;
		    background-color: transparent;
			color:white;
			font-family: 'æ–°å­—ä½“';
			font-size: 25px;
			position: absolute;
			left: 35%;
			top: 6%;
            text-shadow: 2px 2px 2px #E6E6FA;
		}


        #map {
            width: 100%;
            height: 100%;
        }

        /* æ¶ˆæ¯å†…å®¹ */
		.BMap_bubble_content {
			background-color:white;
			padding-left:10px;
			padding-right: 10px;
			padding-top:5px;
			padding-bottom:10px;
		}

        /*åœ°å›¾æ ‡é¢˜*/
		.BMap_bubble_title {
			color:white;
			font-size:13px;
			font-weight:bold;
			text-align: center;
			border-bottom:1px solid white;
			background-color:	#B0C4DE;
			line-height:30px !important;
		}

		/* å·¦ä¸Šè§’åˆ é™¤æŒ‰é”® */
		.BMap_pop img {
            color:transparent;
			top:45px !important;
			/*left:215px !important;*/
			margin-left:-10px;
		}

        .BMap_top {
			display:none;
		}
        .BMap_center{
            display: none;
        }
        .BMap_bottom{
            display: none;
        }

        /* éšè—è¾¹è§’ */
		.BMap_pop div:nth-child(1) div {
			display:none;
		}
		.BMap_pop div:nth-child(3){
            display: none;
        }
        .BMap_pop div:nth-child(5){
            display: none;
        }
        .BMap_pop div:nth-child(7){
            display: none;
        }
       
        /* å†…å®¹ */
		.BMap_pop div:nth-child(9) {
			top:35px !important;
			border-radius:7px;
        }

    </style>
</head>
<body>
    <p class="myTitle">æ•£è½çš„æ˜ç â€”â€”é’è—åœ°åŒºå°‘æ•°æ°‘æ—åˆ†å¸ƒåœ°å›¾<br></p>
    <div id="map"></div>
    <canvas id="canvas"></canvas>

    <script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=m5YH0l8iZEk3sNPWTCSyuC9uiuxmnxym"></script>
    <script type="text/javascript" src="build/mapv.js"></script>

    <script type="text/javascript">
        // ç™¾åº¦åœ°å›¾APIåŠŸèƒ½
        var map = new BMap.Map("map", {
            enableMapClick: false
        });    // åˆ›å»ºMapå®ä¾‹
        map.centerAndZoom(new BMap.Point(94.217562,33.871766), 6);  // åˆå§‹åŒ–åœ°å›¾,è®¾ç½®ä¸­å¿ƒç‚¹åæ ‡å’Œåœ°å›¾çº§åˆ«
        //map.enableScrollWheelZoom(false); // å¼€å¯é¼ æ ‡æ»šè½®ç¼©æ”¾
        madeBoundary();
        map.setMapStyle({
            style: 'midnight'
        });

        function madeBoundary(){
            var datas = new Array("è¥¿è—è‡ªæ²»åŒº","é’æµ·çœ","ç”˜å­œè—æ—è‡ªæ²»å·","é˜¿åè—æ—ç¾Œæ—è‡ªæ²»å·","ç”˜å—è—æ—è‡ªæ²»å·");
            var bdary = new BMap.Boundary();
            for(var i = 0;i < datas.length;i++){
                getBoundary(datas[i],bdary);
            }
        }

        function getBoundary(data,bdary){
            //data = data.split("-");
            bdary.get(data,function(rs){
                //map.clearOverlays();
                var count = rs.boundaries.length;
                if(count == 0){
                    alert('æœªèƒ½è·å–å½“å‰è¾“å…¥è¡Œæ”¿åŒºåŸŸ');
                    return;
                }
                var pointArray = [];
                for(var i = 0;i < count;i++){
                    var ply = new BMap.Polygon(rs.boundaries[i],{strokeWeight:1,strokeColor:"#DCDCDC",fillOpacity:0.5,fillColor:"#87CEEB"});
                    map.addOverlay(ply);
                    pointArray = pointArray.concat(ply.getPath());
                }
                //map.setViewport(pointArray);
                //addlabel();
            });
        }

        //var size = new BMap.Size(10, 20);   //æ§ä»¶ä½ç½®
        //map.addControl(new BMap.CityListControl({
        //    anchor: BMAP_ANCHOR_TOP_LEFT,
        //    offset: size,
            // åˆ‡æ¢åŸå¸‚ä¹‹å‰äº‹ä»¶
            //onChangeBefore: function(){
                //alert('å³å°†åˆ‡æ¢åˆ°æ‚¨é€‰æ‹©çš„åŸå¸‚');
            //},
            // åˆ‡æ¢åŸå¸‚ä¹‹åäº‹ä»¶
            //onChangeAfter:function(){
                //alert('å·²åˆ‡æ¢åˆ°æ‚¨é€‰æ‹©çš„åŸå¸‚');
            //}
        //}));


        var data_info = [[91.16811,29.651452,"è—æ—","è—æ—æ˜¯é’è—é«˜åŸçš„åŸä½æ°‘ã€‚è—æ—æ™®éä¿¡ä»°è—ä¼ ä½›æ•™ï¼Œè—ä¼ ä½›æ•™åˆåˆä¿—ç§°å–‡å˜›æ•™ã€‚è—æ—äººæ°‘åˆ›é€ äº†ç¿çƒ‚çš„æ°‘æ—æ–‡åŒ–ï¼Œå°¤å…¶åœ¨åœ¨æ–‡å­¦ã€éŸ³ä¹ã€èˆè¹ˆã€ç»˜ç”»ã€é›•å¡‘ã€å»ºç­‘è‰ºæœ¯ç­‰æ–¹é¢ï¼Œç•™ä¸‹äº†æä¸ºä¸°å¯Œçš„æ–‡åŒ–é—äº§ã€‚è—æ—é›•åˆ»æŠ€è‰ºé«˜è¶…ã€‚æ­¤å¤–è—æˆç‹¬å…·ç‰¹è‰²ï¼Œè—åŒ»è¯å­¦ä¹Ÿæ˜¯äººç±»é‡è¦é—äº§ã€‚"],
                        [102.227967,31.907964,"ç¾Œæ—","ç¾Œæ—æºäºå¤ç¾Œï¼Œæ˜¯ä¸­å›½è¥¿éƒ¨çš„å¤è€æ°‘æ—ï¼Œè¢«ç§°ä¸ºâ€œäº‘æœµä¸Šçš„æ°‘æ—â€ã€‚ç¾Œæ—é™¤ä¸€éƒ¨åˆ†é‚»è¿‘è—æ—åœ°åŒºçš„ä¿¡ä»°è—ä¼ ä½›æ•™å¤–ï¼Œå…¶ä½™æ™®éä¿¡ä»°åŸå§‹å®—æ•™ï¼Œå³ä¸‡ç‰©æœ‰çµã€å¤šç¥ä¿¡ä»°å’Œç¥–å…ˆå´‡æ‹œã€‚å¤ç¾Œå¯¹ä¸­å›½å†å²å‘å±•å’Œä¸­åæ°‘æ—çš„å½¢æˆéƒ½æœ‰ç€å¹¿æ³›è€Œæ·±è¿œçš„å½±å“ã€‚å…¶æ°‘æ—è¯­è¨€ä¸ºç¾Œè¯­ã€‚"]];
        var data_info2 = [[91.957999,27.998536,"é—¨å·´æ—ï¼ˆäººæ•°æå°‘ï¼‰","æ˜¯ä¸­å›½å…·æœ‰æ‚ ä¹…å†å²æ–‡åŒ–çš„æ°‘æ—ä¹‹ä¸€ï¼Œæ°‘æ—è¯­è¨€ä¸ºé—¨å·´è¯­ï¼Œå±æ±‰è—è¯­ç³»è—ç¼…è¯­æ—è—è¯­æ”¯ï¼Œæ–¹è¨€å·®åˆ«è¾ƒå¤§ï¼Œæ— æœ¬æ°‘æ—æ–‡å­—ï¼Œé€šç”¨è—æ–‡ã€‚é—¨å·´æ—äººæ°‘å’Œè—æ—äººæ°‘é•¿æœŸå‹å¥½å¾€æ¥ï¼Œäº’é€šå©šå§»ï¼Œåœ¨æ”¿æ²»ã€ç»æµã€æ–‡åŒ–ã€å®—æ•™ä¿¡ä»°ã€ç”Ÿæ´»ä¹ ä¿—ç­‰æ–¹é¢éƒ½æœ‰ååˆ†å¯†åˆ‡çš„å…³ç³»ã€‚"],];
        var data_info3 = [[101.797249,36.529165,"å›æ—","å›æ—æ˜¯ä¸­å›½äººå£è¾ƒå¤šçš„ä¸€ä¸ªå°‘æ•°æ°‘æ—ï¼Œå…¨å›½çš„31ä¸ªçœã€è‡ªæ²»åŒºã€ç›´è¾–å¸‚å‡æœ‰åˆ†å¸ƒã€‚ä¼Šæ–¯å…°æ•™åœ¨å›æ—çš„å½¢æˆå’Œå‘å±•ä¸­å§‹ç»ˆèµ·ç€ä¸å¯å¿½è§†çš„ä½œç”¨ï¼Œåœ¨å›æ—å½¢æˆåï¼Œå„åœ°å›æ—ä¸€ç›´å»¶ç»­ç€è¿™ä¸€ä¿¡ä»°ã€‚å›æ—ä¿ç•™äº†å¤§é‡çš„é˜¿æ‹‰ä¼¯è¯­å’Œæ³¢æ–¯è¯­çš„è¯æ±‡ã€‚åœ¨æ—¥å¸¸è¯­è¨€è¡¨è¾¾ä¸Šï¼ŒåŸå¸‚å›æ—é€šç”¨æ±‰è¯­ã€‚"]];

        var opts = {
            width:250,
            height:240,
            title:"é’è—åœ°åŒºä¸»è¦å°‘æ•°æ°‘æ—ä¿¡æ¯",
            enableMessage:true  //å…è®¸çª—å£å‘é€æ¶ˆæ¯
        };


        var myIcon = new BMap.Icon("download/icon/ç²®é£Ÿ5.png",new BMap.Size(32,32));
        var myIcon2 = new BMap.Icon("download/icon/ç²®é£Ÿ4.png",new BMap.Size(32,32));
        var myIcon3 = new BMap.Icon("download/icon/æ³°å§¬é™µ2.png",new BMap.Size(48,48));

        for(var i = 0; i < data_info.length;i++){
            var marker = new BMap.Marker(new BMap.Point(data_info[i][0],data_info[i][1]),{icon:myIcon});
            var content = "<h5 style = 'margin:0 0 5px;padding:0.2em 0'>"+ data_info[i][2] + "</h5>"+
                         "<p style = 'margin:0;line-height:1.5;font-size:14px;text-indent:2em'>" + data_info[i][3] + "</p>";
            map.addOverlay(marker);
            addClickHandler(content,marker);
            marker.setAnimation(BMAP_ANIMATION_BOUNCE);
        }
        function addClickHandler(content,marker){
            marker.addEventListener("click",function(e){
                openInfo(content,e)
            });
        }
        function openInfo(content,e){
            var p = e.target;
            var point = new BMap.Point(p.getPosition().lng,p.getPosition().lat);
            var infoWindow = new BMap.InfoWindow(content,opts);
            map.openInfoWindow(infoWindow,point);
        }

        for(var i = 0; i < data_info2.length;i++){
            var marker2 = new BMap.Marker(new BMap.Point(data_info2[i][0],data_info2[i][1]),{icon:myIcon2});
            var content2 = "<h5 style = 'margin:0 0 5px;padding:0.2em 0'>"+ data_info2[i][2] + "</h5>"+
                         "<p style = 'margin:0;line-height:1.5;font-size:14px;text-indent:2em'>" + data_info2[i][3] + "</p>";
            map.addOverlay(marker2);
            addClickHandler(content2,marker2);
            marker2.setAnimation(BMAP_ANIMATION_DROP);
        }
        function addClickHandler2(content,marker){
            marker2.addEventListener("click",function(e){
                openInfo2(content2,e)
            });
        }
        function openInfo2(content,e){
            var p = e.target;
            var point = new BMap.Point(p.getPosition().lng,p.getPosition().lat);
            var infoWindow = new BMap.InfoWindow(content2,opts);
            map.openInfoWindow(infoWindow,point);
        }

        for(var i = 0; i < data_info3.length;i++){
            var marker3 = new BMap.Marker(new BMap.Point(data_info3[i][0],data_info3[i][1]),{icon:myIcon3});
            var content3 = "<h5 style = 'margin:0 0 5px;padding:0.2em 0'>"+ data_info3[i][2] + "</h5>"+
                         "<p style = 'margin:0;line-height:1.5;font-size:14px;text-indent:2em'>" + data_info3[i][3] + "</p>";
            map.addOverlay(marker3);
            addClickHandler(content3,marker3);
            //marker3.setAnimation(BMAP_ANIMATION_BOUNCE);
        }
        function addClickHandler3(content,marker){
            marker.addEventListener("click",function(e){
                openInfo(content3,e)
            });
        }
        function openInfo3(content,e){
            var p = e.target;
            var point = new BMap.Point(p.getPosition().lng,p.getPosition().lat);
            var infoWindow = new BMap.InfoWindow(content3,opts);
            map.openInfoWindow(infoWindow,point);
        }

        map.addEventListener("click",function(e){
		    alert('æ‚¨æ‰€ç‚¹å‡»å¤„ç»çº¬åº¦ä¸º' + e.point.lng + "," + e.point.lat);
	    });

        // å¤æ‚çš„è‡ªå®šä¹‰è¦†ç›–ç‰©
        function ComplexCustomOverlay(point, text, mouseoverText){
          this._point = point;
          this._text = text;
          this._overText = mouseoverText;
        }
        ComplexCustomOverlay.prototype = new BMap.Overlay();
        ComplexCustomOverlay.prototype.initialize = function(map){
            this._map = map;
            var div = this._div = document.createElement("div");
            div.style.position = "absolute";
            div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);
            //div.style.backgroundColor = "#87CEEB";
            div.style.backgroundColor = "transparent";
            div.style.border = "1px solid transparent";//#EE5D5B
            div.style.color = "white";
            div.style.height = "18px";
            div.style.padding = "2px";
            div.style.lineHeight = "18px";
            div.style.whiteSpace = "nowrap";
            div.style.MozUserSelect = "none";
            div.style.fontSize = "12px";
            var span = this._span = document.createElement("span");
            div.appendChild(span);
            span.appendChild(document.createTextNode(this._text));      
            var that = this;

            var arrow = this._arrow = document.createElement("div");
            arrow.style.background = "url(http://map.baidu.com/fwmap/upload/r/map/fwmap/static/house/images/label.png) no-repeat";
            arrow.style.position = "absolute";
            arrow.style.width = "11px";
            arrow.style.height = "10px";
            arrow.style.top = "22px";
            arrow.style.left = "10px";
            arrow.style.overflow = "hidden";
            //arrow.style.backgroundColor = "transparent";
            div.appendChild(arrow);
     
            div.onmouseover = function(){
                this.style.backgroundColor = "transparent";
                this.style.borderColor = "#B0C4DE";
                this.getElementsByTagName("span")[0].innerHTML = that._overText;
                arrow.style.backgroundPosition = "0px -20px";
            }

            div.onmouseout = function(){
                this.style.backgroundColor = "transparent";
                this.style.borderColor = "transparent";
                this.getElementsByTagName("span")[0].innerHTML = that._text;
                arrow.style.backgroundPosition = "0px 0px";
            }

            map.getPanes().labelPane.appendChild(div); 
            return div;
        }

        ComplexCustomOverlay.prototype.draw = function(){
            var map = this._map;
            var pixel = map.pointToOverlayPixel(this._point);
            this._div.style.left = pixel.x - parseInt(this._arrow.style.left) + "px";
            this._div.style.top  = pixel.y - 30 + "px";
        }

        var txt = "è¯¥åœ°ä¸»è¦åˆ†å¸ƒå°‘æ•°æ°‘æ—ï¼š", mouseoverTxt = txt + "è—æ—";
        var text_point = [[99.847135,34.285113],[100.215081,37.6054],
                        [97.013951,30.890464],[101.061356,30.061816]];
        for(var i = 0;i < text_point.length;i++){
            var myCompOverlay = new ComplexCustomOverlay(new BMap.Point(text_point[i][0],text_point[i][1]),"ğŸ‘ğŸ‘ğŸ‘",mouseoverTxt); 
            map.addOverlay(myCompOverlay);
        }
    

        var data = [];

        //91.162935,29.651954æ‹‰è¨  97.142733,30.787274æ˜Œéƒ½ 101.907633,30.205744ç”˜å­œ 101.65007,36.707137è¥¿å®
        var randomCount = 450;
            while(randomCount--){
                data.push({
                geometry: {
                    type: 'Point',
                    coordinates:[80.162935 + Math.random() * 20,28.651954 + Math.random() * 3]
                },
                count: 20 * Math.random(),
            });
        }

        var randomCount = 20;   //æ‹‰è¨
            while(randomCount--){
                data.push({
                geometry: {
                    type: 'Point',
                    coordinates:[91.162935 + Math.random() * 0.5,29.651954 + Math.random() * 0.5]
                },
                count: 20 * Math.random(),
            });
        }

        var randomCount = 20;   //æ˜Œéƒ½
            while(randomCount--){
                data.push({
                geometry: {
                    type: 'Point',
                    coordinates:[97.142733 + Math.random() * 0.5,30.787274 + Math.random() * 0.5]
                },
                count: 20 * Math.random(),
            });
        }

        var randomCount = 220;
            while(randomCount--){
                data.push({
                geometry: {
                    type: 'Point',
                    coordinates:[97.142733 + Math.random() * 8,30.787274 + Math.random() * 2]
                },
                count: 20 * Math.random(),
            });
        }

        var randomCount = 30;
            while(randomCount--){
                data.push({
                geometry: {
                    type: 'Point',
                    coordinates:[100.007633 + Math.random() * 1,29.205744 + Math.random() * 1]
                },
                count: 20 * Math.random(),
            });
        }

        var randomCount = 100;
            while(randomCount--){
                data.push({
                geometry: {
                    type: 'Point',
                    coordinates:[99.65007 + Math.random() * 2,33.707137 + Math.random() * 5]
                },
                count: 20 * Math.random(),
            });
        }

        var dataSet = new mapv.DataSet(data);
        var options = {
            size: 13,
            gradient: { 0.25: "rgb(0,0,255)", 0.55: "rgb(0,255,0)", 0.85: "yellow", 1.0: "rgb(255,0,0)"},
            max: 100,
            draw: 'heatmap'
        }
        var mapvLayer = new mapv.baiduMapLayer(map, dataSet, options);

    </script>
	
</body>
</html>
